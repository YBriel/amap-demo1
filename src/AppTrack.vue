<template>
    <div id="test-map" />
</template>

<script>
    import { lazyAMapApiLoaderInstance } from 'vue-amap'
    export default {
        data() {
            return {
                map: '', // 地图
                // 轨迹数组，格式[{},{},...]
                path: [
                    {
                        path: /*[
                            [115.841818,28.740776],
                            [115.853319,28.742808],
                            [115.867052,28.742507],
                            [115.879755,28.742055],
                            [115.890055,28.745517]
                        ]*/
                            //[[115.842574,28.738859], [115.842652,28.738242], [115.842786,28.736884], [115.842791,28.736675], [115.842721,28.736207], [115.842721,28.736207], [115.842595,28.736133], [115.84253,28.736046], [115.842509,28.735985], [115.842517,28.735872], [115.842552,28.735751], [115.8426,28.735668], [115.842674,28.735603], [115.842747,28.735577], [115.842747,28.735577], [115.84286,28.735304], [115.842899,28.735148], [115.84293,28.73497], [115.84296,28.734536], [115.843064,28.733381], [115.843103,28.733012], [115.84319,28.732135], [115.843194,28.732075], [115.843212,28.731897], [115.843277,28.731189], [115.843437,28.729444], [115.843451,28.729245], [115.843455,28.729149], [115.843533,28.72885], [115.843906,28.728898], [115.844375,28.72895], [115.844635,28.728945], [115.844635,28.728945], [115.846228,28.728958], [115.846984,28.728958], [115.848012,28.72895], [115.848012,28.72895], [115.848342,28.729063], [115.851285,28.729089], [115.853307,28.72908], [115.854865,28.729097], [115.856897,28.729119], [115.857582,28.729136], [115.858754,28.729232], [115.858885,28.729245], [115.859275,28.729293], [115.859436,28.729314], [115.860178,28.729423], [115.86102,28.729566], [115.861814,28.729701], [115.86283,28.72987], [115.864796,28.730191], [115.865495,28.730291], [115.866198,28.73036], [115.866684,28.730404], [115.867517,28.730447], [115.868086,28.73046], [115.868915,28.730451], [115.869679,28.730421], [115.872066,28.730256], [115.875868,28.729983], [115.876055,28.729965], [115.878685,28.729779], [115.878993,28.729757], [115.879484,28.729718], [115.87987,28.729679], [115.880951,28.729605], [115.88194,28.729531], [115.883181,28.72944], [115.883364,28.729427], [115.883785,28.729397], [115.884232,28.729362], [115.884553,28.72934], [115.886046,28.729245], [115.886589,28.72921], [115.886884,28.729188], [115.887439,28.729149], [115.890104,28.72895], [115.892873,28.728759], [115.893021,28.728746], [115.897027,28.728464], [115.897192,28.728451], [115.900061,28.728247], [115.900916,28.728129], [115.90125,28.728056], [115.901619,28.727947], [115.901992,28.727817], [115.902344,28.727669], [115.902674,28.727513], [115.902982,28.727339], [115.903251,28.72717], [115.903585,28.726923], [115.903824,28.726732], [115.904132,28.726441], [115.904397,28.726163], [115.905369,28.725056], [115.90576,28.724605], [115.907153,28.723008], [115.907552,28.722556], [115.907986,28.72201], [115.908199,28.721766], [115.90852,28.721406], [115.90885,28.721042], [115.909041,28.720825], [115.90987,28.719883], [115.911289,28.71826], [115.91138,28.71816], [115.912075,28.717365], [115.914271,28.714835], [115.915664,28.713251], [115.916107,28.712739], [115.916198,28.712617], [115.916198,28.712617], [115.916233,28.712183], [115.916237,28.712131], [115.91622,28.712014], [115.916189,28.711897], [115.916124,28.711766], [115.916042,28.711662], [115.915959,28.711571], [115.915833,28.71148], [115.915699,28.711402], [115.915543,28.711345], [115.91536,28.711302], [115.915165,28.711285], [115.914154,28.711237], [115.91395,28.711094], [115.913689,28.710842], [115.912943,28.709965], [115.912747,28.709766], [115.912517,28.709579], [115.909562,28.70753], [115.909197,28.707274], [115.907713,28.70622], [115.907769,28.706098], [115.90865,28.70559], [115.908902,28.705451], [115.909149,28.70533], [115.909488,28.705208], [115.909874,28.705113], [115.910217,28.705069], [115.910304,28.705056], [115.911784,28.705056], [115.912526,28.705052]]
                            [[115.859384,28.687274], [115.859323,28.68727], [115.859323,28.68727], [115.859323,28.687096], [115.859319,28.686931], [115.859297,28.686823], [115.859288,28.686758], [115.859288,28.686758], [115.858129,28.687209], [115.857704,28.687383], [115.85763,28.687409], [115.857287,28.687543], [115.855881,28.688108], [115.855043,28.688433], [115.855043,28.688433], [115.854974,28.68855], [115.854948,28.688628], [115.854883,28.688928], [115.854883,28.688928], [115.855161,28.689462], [115.85543,28.689926], [115.855851,28.690538], [115.856237,28.690985], [115.856458,28.691181], [115.85724,28.691914], [115.857513,28.69217], [115.85776,28.692339], [115.858503,28.692778], [115.85875,28.692908], [115.859036,28.693043], [115.859457,28.693207], [115.859887,28.693351], [115.860286,28.693507], [115.860386,28.693546], [115.860799,28.693707], [115.861072,28.693798], [115.861341,28.693893], [115.861814,28.694063], [115.861944,28.694102], [115.862899,28.694431], [115.863885,28.6948], [115.864227,28.694952], [115.864275,28.694978], [115.864583,28.695117], [115.865069,28.695312], [115.865764,28.695586], [115.866593,28.695907], [115.866749,28.696007], [115.867023,28.696276], [115.867036,28.696285], [115.867318,28.696593], [115.86799,28.697331], [115.868911,28.698346], [115.868958,28.698394], [115.869136,28.69839], [115.86931,28.698589], [115.869388,28.698689], [115.869505,28.698828], [115.869809,28.699188], [115.870686,28.700239], [115.870707,28.70026], [115.871263,28.70089], [115.871424,28.701072], [115.871632,28.701341], [115.87168,28.701406], [115.871888,28.701658], [115.872005,28.70181], [115.872166,28.702031], [115.873116,28.70332], [115.87355,28.703915], [115.87355,28.703915], [115.873303,28.704071], [115.872895,28.703524], [115.872609,28.703129]]
                    }
                ]
            }
        },
        mounted() {
            lazyAMapApiLoaderInstance.load().then(() => {
                this.map = new AMap.Map('test-map', {
                    zooms: [13, 18], // 地图缩放范围
                   // center: new AMap.LngLat(115.850573,28.732573)
                    center: new AMap.LngLat(115.842574,28.738859)
                })
                AMapUI.load(['ui/misc/PathSimplifier'], (PathSimplifier) => {
                    if (!PathSimplifier.supportCanvas) {
                        alert('当前环境不支持 Canvas！')
                        return
                    }
                    // 创建组件实例
                    var pathSimplifierIns = new PathSimplifier({
                        map: this.map,
                        zIndex: 100, // 图层叠加顺序
                        data: this.path, // 巡航路径
                        // 获取巡航路径中的路径坐标数组
                        getPath: (pathData, pathIndex) => {
                            return pathData.path
                        },
                      renderOptions:{
                        pathLineStyle:{
                          strokeStyle: 'red'
                        },
                        keyPointTolerance:1,
                      //  renderAllPointsIfNumberBelow:87,
                        keyPointStyle: {
                          radius: 4,
                          fillStyle: "red",
                          strokeStyle: "yellow",
                          lineWidth: 1
                        }
                      }
                    })
                    // 创建巡航器
                    var pathNavigator = pathSimplifierIns.createPathNavigator(0, {
                        loop: true, // 是否循环
                        speed: 2000 // 速度(km/h)
                    })
                    pathNavigator.start()
                })
            })
        }
    }
</script>

<style scoped>
    #test-map{
        height: 650px;
    }
</style>
